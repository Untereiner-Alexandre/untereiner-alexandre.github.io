import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.WFquGv8Z.js";import{s as e}from"./contact.eb056b00.CdsirVGB.js";const S="0x4AAAAAACTrAgZbrAVTUH8Y",y="https://contact.untereineralexandre-dev.workers.dev",j=600*1e3,T=({i18n:s={}})=>{const[r,m]=i.useState({name:"",email:"",message:"",honeypot:""}),[u,c]=i.useState(""),[d,f]=i.useState(!1),[l,g]=i.useState(!1),h=i.useRef(null),p=i.useRef(null);i.useEffect(()=>{window.onTurnstileSuccess=o=>{p.current=o,c("")};const a=localStorage.getItem("lastContactTimestamp");a&&Date.now()-parseInt(a)<j&&(g(!0),c(`⏳ ${s?.error_already_sent||"Slow down!"}`));const n=()=>{window.turnstile&&h.current&&h.current.innerHTML===""&&!l&&window.turnstile.render(h.current,{sitekey:S,callback:"onTurnstileSuccess",theme:document.documentElement.classList.contains("dark")?"dark":"light"})};if(document.querySelector('script[src*="turnstile"]'))setTimeout(n,500);else{const o=document.createElement("script");o.src="https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit",o.async=!0,o.onload=()=>setTimeout(n,500),document.body.appendChild(o)}},[l]);const x=async a=>{if(a.preventDefault(),!p.current){const n=window.turnstile?.getResponse();if(n)p.current=n;else{c(`⏳ ${s?.error_no_captcha||"Validation en cours..."}`);return}}f(!0),c(s.status_sending);try{const n=await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.name,email:r.email,message:r.message,captchaToken:p.current})});if(n.ok)localStorage.setItem("lastContactTimestamp",Date.now().toString()),c("✅ "+s.status_success),m({name:"",email:"",message:"",honeypot:""}),g(!0),p.current=null;else{const o=await n.json().catch(()=>({}));c(`❌ ${o.error||s.error_server||"Server Error"}`)}}catch{c(`❌ ${s.error_network||"Network Error"}`)}finally{f(!1)}},b=()=>u?u.startsWith("✅")?e.statusSuccess:u.startsWith("⏳")||u.startsWith("⚠️")?e.statusInfo:e.statusError:"";return t.jsxs("div",{className:e.container,children:[u&&t.jsx("div",{className:`${e.statusMessage} ${b()}`,children:u}),t.jsxs("form",{onSubmit:x,className:`${e.form} ${l?e.isLocked:""}`,children:[t.jsx("input",{type:"text",name:"honeypot",className:e.honeypot,onChange:a=>m({...r,honeypot:a.target.value}),tabIndex:-1}),t.jsxs("div",{className:e.fieldGroup,children:[t.jsx("label",{className:e.label,children:s.label_name}),t.jsx("input",{type:"text",value:r.name,onChange:a=>m({...r,name:a.target.value}),required:!0,disabled:d||l,className:e.input})]}),t.jsxs("div",{className:e.fieldGroup,children:[t.jsx("label",{className:e.label,children:s.label_email}),t.jsx("input",{type:"email",value:r.email,onChange:a=>m({...r,email:a.target.value}),required:!0,disabled:d||l,className:e.input})]}),t.jsxs("div",{className:e.fieldGroup,children:[t.jsx("label",{className:e.label,children:s.label_message}),t.jsx("textarea",{rows:5,value:r.message,onChange:a=>m({...r,message:a.target.value}),required:!0,disabled:d||l,className:e.textarea})]}),t.jsx("div",{style:{minHeight:"65px",marginTop:"10px"},children:t.jsx("div",{ref:h})}),t.jsx("button",{type:"submit",disabled:d||l,className:e.submitButton,children:d?s.status_sending:l?s.status_success:s.btn_submit})]})]})};export{T as default};
